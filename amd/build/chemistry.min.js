define("tiny_chemistry/chemistry",["exports","tiny_chemistry/selectors"],(function(_exports,_selectors){var obj;
/**
   * Chemistry helper for Tiny Chemistry plugin.
   *
   * @module      tiny_chemistry/chemistry
   * @copyright   adapted for chemistry 2023 TOP Lehre FH OOE, Campus Hagenberg (elearning@fh-hagenberg.at), original based on Huong Nguyen <huongnv13@gmail.com> for equation (2022)
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.setChemistry=_exports.getSourceChemistry=_exports.getSelectedChemistry=_exports.getCurrentChemistryData=void 0,_selectors=(obj=_selectors)&&obj.__esModule?obj:{default:obj};let sourceChemistry=null;const getSourceChemistry=()=>sourceChemistry;_exports.getSourceChemistry=getSourceChemistry;const getSelectedChemistry=editor=>{const currentSelection=editor.selection.getSel();if(!currentSelection)return!1;const textSelection=editor.selection.getNode().textContent,currentCaretPos=currentSelection.focusOffset;let returnValue=!1;return _selectors.default.chemistryPatterns.forEach((pattern=>{const regexPattern=new RegExp(pattern.source,"g");[...textSelection.matchAll(regexPattern)].forEach((matches=>{const match=matches[0];let startIndex=0;const startOuter=textSelection.indexOf(match,startIndex),endOuter=startOuter+match.length,innerMatch=match.match(pattern);if(innerMatch&&innerMatch.length){const startInner=textSelection.indexOf(innerMatch[1],startOuter),endInner=startInner+innerMatch[1].length;if(currentCaretPos>=startOuter&&currentCaretPos<=endOuter)return returnValue=innerMatch[1],void(sourceChemistry={startInnerPosition:startInner,endInnerPosition:endInner,innerMatch:innerMatch})}startIndex=endOuter}))})),!1!==returnValue?returnValue=returnValue.trim():sourceChemistry=null,returnValue};_exports.getSelectedChemistry=getSelectedChemistry;_exports.getCurrentChemistryData=editor=>{let properties={};const chemistry=getSelectedChemistry(editor);return chemistry&&(properties.chemistry=chemistry),properties};_exports.setChemistry=(currentForm,editor)=>{const input=currentForm.querySelector(_selectors.default.elements.chemistryTextArea),sourceChemistry=getSourceChemistry();let value=input.value;if(""!==value)if(sourceChemistry){const selectedNode=editor.selection.getNode(),text=selectedNode.textContent;value=" "+value+" ",selectedNode.textContent=text.slice(0,sourceChemistry.startInnerPosition)+value+text.slice(sourceChemistry.endInnerPosition)}else value=_selectors.default.delimiters.start+" "+value+" "+_selectors.default.delimiters.end,editor.insertContent(value)}}));

//# sourceMappingURL=chemistry.min.js.map